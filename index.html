<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CHAAYE JUNCTION - Freshness in Every Sip</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&family=Satisfy&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #FFF8E1;
            margin: 0;
            padding: 0;
        }
        .font-script {
            font-family: 'Satisfy', cursive;
        }
        
        /* Custom Animations */
        @keyframes fade-in-up {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in-up {
            animation: fade-in-up 1s ease-out forwards;
        }

        @keyframes pulse-slow {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .animate-pulse-slow {
            animation: pulse-slow 2s infinite ease-in-out;
        }

        @keyframes slide-in-right {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        .animate-slide-in-right {
            animation: slide-in-right 0.3s ease-out forwards;
        }

        @keyframes scale-in {
            from { transform: scale(0.9); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .animate-scale-in {
            animation: scale-in 0.3s ease-out forwards;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .animate-bounce {
            animation: bounce 1s infinite;
        }

        @keyframes checkmark-pop {
            0% { transform: scale(0.5); opacity: 0; }
            50% { transform: scale(1.2); opacity: 1; }
            100% { transform: scale(1); }
        }
        .checkmark-pop {
            animation: checkmark-pop 0.5s ease-out;
        }

        /* Enhanced Splash Screen Animations */
        @keyframes mug-float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-10px) rotate(-2deg); }
            50% { transform: translateY(-5px) rotate(2deg); }
            75% { transform: translateY(-8px) rotate(-1deg); }
        }
        .animate-mug-float {
            animation: mug-float 3s infinite ease-in-out;
        }

        @keyframes text-glow {
            0%, 100% { text-shadow: 0 0 5px rgba(109, 76, 65, 0.3); }
            50% { text-shadow: 0 0 15px rgba(109, 76, 65, 0.6); }
        }
        .animate-text-glow {
            animation: text-glow 2s infinite ease-in-out;
        }

        @keyframes steam-rise {
            0% { transform: translateY(0) scaleY(1); opacity: 0.7; }
            50% { transform: translateY(-15px) scaleY(1.2); opacity: 0.4; }
            100% { transform: translateY(-30px) scaleY(1.5); opacity: 0; }
        }
        .animate-steam-rise {
            animation: steam-rise 2s infinite ease-out;
        }

        /* Menu Item Animation */
        @keyframes item-added {
            0% { transform: scale(1); border-color: #fed7aa; }
            50% { transform: scale(1.03); border-color: #10B981; box-shadow: 0 0 15px rgba(16, 185, 129, 0.4); }
            100% { transform: scale(1); border-color: #fed7aa; }
        }
        .animate-item-added {
            animation: item-added 0.6s ease-out;
        }

        /* Form Field Animations */
        @keyframes field-focus {
            0% { transform: scale(1); box-shadow: 0 0 0 rgba(109, 76, 65, 0); }
            50% { transform: scale(1.01); box-shadow: 0 0 10px rgba(109, 76, 65, 0.2); }
            100% { transform: scale(1); box-shadow: 0 0 0 rgba(109, 76, 65, 0); }
        }
        .animate-field-focus {
            animation: field-focus 0.5s ease-out;
        }

        @keyframes form-field-appear {
            0% { opacity: 0; transform: translateY(10px) scale(0.95); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }
        .animate-form-field-appear {
            animation: form-field-appear 0.5s ease-out forwards;
        }

        /* Cart Icon Animation */
        @keyframes cart-bounce {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.2); }
            50% { transform: scale(0.9); }
            75% { transform: scale(1.1); }
        }
        .animate-cart-bounce {
            animation: cart-bounce 0.5s ease-out;
        }

        /* NEW ANIMATIONS */
        @keyframes stagger-fade-in {
            from { opacity: 0; transform: translateY(30px) rotateX(10deg); }
            to { opacity: 1; transform: translateY(0) rotateX(0); }
        }
        .stagger-item {
            animation: stagger-fade-in 0.6s ease-out forwards;
            opacity: 0;
        }

        @keyframes price-bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); color: #E65100; }
        }
        .price-tag:hover {
            animation: price-bounce 0.5s ease-in-out;
        }

        @keyframes ripple {
            0% {
                transform: scale(0);
                opacity: 1;
            }
            100% {
                transform: scale(4);
                opacity: 0;
            }
        }
        .ripple-effect {
            position: relative;
            overflow: hidden;
        }
        .ripple-effect::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 5px;
            height: 5px;
            background: rgba(109, 76, 65, 0.6);
            opacity: 0;
            border-radius: 100%;
            transform: scale(1) translate(-50%, -50%);
            transform-origin: 50% 50%;
        }
        .ripple-effect:active::after {
            animation: ripple 0.6s ease-out;
        }

        @keyframes category-expand {
            from { 
                max-height: 0;
                opacity: 0;
                transform: translateY(-20px);
            }
            to { 
                max-height: 1000px;
                opacity: 1;
                transform: translateY(0);
            }
        }
        .category-section {
            animation: category-expand 0.8s ease-out forwards;
            overflow: hidden;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        .floating-btn {
            animation: float 3s ease-in-out infinite;
            box-shadow: 0 10px 25px rgba(109, 76, 65, 0.3);
        }
        .floating-btn:hover {
            animation: none;
            transform: translateY(-5px);
        }

        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }
        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: #6D4C41 }
        }
        .typing-animation {
            overflow: hidden;
            border-right: 2px solid #6D4C41;
            white-space: nowrap;
            animation: 
                typing 3.5s steps(40, end),
                blink-caret 0.75s step-end infinite;
        }

        @keyframes smooth-scroll {
            0% { transform: translateY(-100px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
        .smooth-scroll-target {
            animation: smooth-scroll 0.8s ease-out forwards;
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        /* NEW FEATURES STYLES */
        .hero-section {
            background: linear-gradient(rgba(109, 76, 65, 0.8), rgba(109, 76, 65, 0.9)), url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%236D4C41"/><path d="M0 0L100 100M100 0L0 100" stroke="%235D4037" stroke-width="1"/></svg>');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }

        .feature-card {
            transition: all 0.3s ease;
            border: 1px solid #fed7aa;
        }
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(109, 76, 65, 0.15);
        }

        .testimonial-card {
            background: linear-gradient(135deg, #FFF8E1 0%, #FFECB3 100%);
            border-left: 4px solid #6D4C41;
        }

        .special-offer {
            background: linear-gradient(135deg, #6D4C41 0%, #8D6E63 100%);
            position: relative;
            overflow: hidden;
        }
        .special-offer::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
            animation: rotate 10s linear infinite;
        }
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        // Menu Data - Updated with only specified items
        const menuData = {
            chaaye: [
                { name: "Tandoori Chaaye", price: 200, desc: "Smoky clay pot flavor", icon: "fire" },
                { name: "Karak Chaaye", price: 150, desc: "Strong & refreshing", icon: "mug-hot" },
                { name: "Doodh Patti", price: 180, desc: "Rich milk tea", icon: "blender" },
                { name: "Qehwa", price: 100, desc: "Traditional green tea", icon: "leaf" },
                { name: "Green Tea", price: 100, desc: "Healthy & light", icon: "seedling" }
            ],
            coffee: [
                { name: "Beat Coffee", price: 250, desc: "Frothy hand-beaten", icon: "coffee" },
                { name: "Black Coffee", price: 150, desc: "Pure caffeine kick", icon: "mug-saucer" }
            ],
            desserts: [
                { name: "Hot Gulab Jamun", price: 200, desc: "Warm sweet delight", icon: "circle" },
                { name: "Boiled Egg", price: 80, desc: "Simple protein snack", icon: "egg" }
            ]
        };

        const phoneNumber = "923441246946";
        const restaurantPhone = "+92 344 1246946";
        const creatorInfo = {
            name: "Amanullah",
            contact: "03015956684"
        };

        // Icon mapping
        const getIcon = (key) => {
            switch (key) {
                case "fire": return "üî•";
                case "mug-hot": return "‚òï";
                case "blender": return "ü•§";
                case "leaf": return "üçÉ";
                case "seedling": return "üå±";
                case "coffee": return "‚òï";
                case "mug-saucer": return "‚òï";
                case "circle": return "üçÆ";
                case "egg": return "ü•ö";
                default: return "‚òï";
            }
        };

        // NEW FEATURES DATA
        const features = [
            { icon: "üöö", title: "Free Delivery", desc: "On orders above Rs. 500" },
            { icon: "‚è∞", title: "Quick Service", desc: "Ready in 10-15 minutes" },
            { icon: "üå±", title: "Fresh Ingredients", desc: "Locally sourced daily" },
            { icon: "üí≥", title: "Easy Payment", desc: "Cash & Digital payments" }
        ];

        const testimonials = [
            { name: "Ali R.", comment: "Best Karak Chai in town! Always fresh and perfectly brewed.", rating: 5 },
            { name: "Sara K.", comment: "Love their Tandoori Chai. The smoky flavor is amazing!", rating: 4 },
            { name: "Ahmed M.", comment: "Fast service and consistent quality. My go-to place for tea.", rating: 5 }
        ];

        // Components
        const SplashScreen = () => {
            return `
                <div class="fixed inset-0 bg-[#FFF8E1] z-50 flex flex-col items-center justify-center text-[#6D4C41]">
                    <div class="relative mb-6">
                        <div class="animate-mug-float text-6xl">‚òï</div>
                        <div class="absolute -top-8 left-1/2 transform -translate-x-1/2 w-4 h-6 bg-gray-200 rounded-full opacity-70 animate-steam-rise"></div>
                        <div class="absolute -top-10 left-1/2 transform -translate-x-1/3 w-3 h-5 bg-gray-300 rounded-full opacity-50 animate-steam-rise" style="animation-delay: 0.5s"></div>
                        <div class="absolute -top-12 left-1/2 transform translate-x-1/4 w-2 h-4 bg-gray-400 rounded-full opacity-40 animate-steam-rise" style="animation-delay: 1s"></div>
                    </div>
                    <h1 class="text-4xl md:text-5xl font-script mb-2 animate-fade-in-up animate-text-glow">Chaaye Junction</h1>
                    <p class="text-sm md:text-base opacity-80 animate-fade-in-up typing-animation" style="animation-delay: 0.3s">
                        Freshness in Every Sip
                    </p>
                </div>
            `;
        };

        const Header = (cartCount, onCartClick, cartAnimation) => {
            return `
                <header class="sticky top-0 z-40 bg-[#6D4C41] text-[#FFF8E1] shadow-md">
                    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
                        <div class="flex items-center gap-2">
                            <span class="text-2xl">‚òï</span>
                            <h1 class="text-xl font-bold font-script tracking-wide">Chaaye Junction</h1>
                        </div>
                        <div class="flex items-center gap-4">
                            <a href="tel:${restaurantPhone.replace(/\s+/g, '')}" class="hidden md:flex items-center gap-1 bg-[#5D4037] px-3 py-1 rounded-full text-sm hover:bg-[#4E342E] transition-colors">
                                <span>üìû</span> ${restaurantPhone}
                            </a>
                            <button onclick="${onCartClick}" class="relative p-2 hover:bg-[#5D4037] rounded-full transition-colors">
                                <span class="text-2xl ${cartAnimation ? 'animate-cart-bounce' : ''}">üõí</span>
                                ${cartCount > 0 ? `
                                    <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold w-5 h-5 flex items-center justify-center rounded-full animate-bounce">
                                        ${cartCount}
                                    </span>
                                ` : ''}
                            </button>
                        </div>
                    </div>
                </header>
            `;
        };

        const HeroSection = () => {
            return `
                <section class="hero-section text-white py-20 md:py-28">
                    <div class="container mx-auto px-4 text-center">
                        <h1 class="text-4xl md:text-6xl font-bold mb-4 font-script animate-fade-in-up">Chaaye Junction</h1>
                        <p class="text-xl md:text-2xl mb-6 animate-fade-in-up" style="animation-delay: 0.2s">Freshness in Every Sip</p>
                        <p class="text-lg mb-8 animate-fade-in-up" style="animation-delay: 0.4s">${restaurantPhone}</p>
                        <button onclick="app.scrollToMenu()" class="floating-btn bg-[#FFA726] text-[#6D4C41] px-8 py-3 rounded-full font-bold hover:bg-[#FF9800] transition-all animate-fade-in-up" style="animation-delay: 0.6s">
                            View Our Menu
                        </button>
                    </div>
                </section>
            `;
        };

        const FeaturesSection = () => {
            const featuresHtml = features.map((feature, index) => `
                <div class="feature-card bg-white p-6 rounded-xl text-center stagger-item" style="animation-delay: ${index * 0.1}s">
                    <div class="text-3xl mb-3">${feature.icon}</div>
                    <h3 class="font-bold text-[#6D4C41] mb-2">${feature.title}</h3>
                    <p class="text-gray-600 text-sm">${feature.desc}</p>
                </div>
            `).join('');

            return `
                <section class="py-12 bg-orange-50">
                    <div class="container mx-auto px-4">
                        <h2 class="text-3xl font-bold text-center text-[#6D4C41] mb-10">Why Choose Us</h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                            ${featuresHtml}
                        </div>
                    </div>
                </section>
            `;
        };

        const CategorySection = (title, items, onAddToCart) => {
            const itemsHtml = items.map((item, index) => `
                <div id="menu-item-${item.name.replace(/\s+/g, '-')}" 
                     class="bg-white p-5 rounded-xl shadow-sm hover:shadow-md transition-all duration-300 border border-orange-100 flex justify-between items-center group menu-item-card stagger-item"
                     style="animation-delay: ${index * 0.1}s">
                    <div class="flex items-center gap-4">
                        <div class="bg-orange-50 p-3 rounded-full text-[#6D4C41] group-hover:bg-[#6D4C41] group-hover:text-white transition-colors">
                            ${getIcon(item.icon)}
                        </div>
                        <div>
                            <h3 class="font-bold text-gray-800">${item.name}</h3>
                            <p class="text-xs text-gray-500">${item.desc}</p>
                            <p class="price-tag text-orange-600 font-semibold mt-1 transition-all duration-300">Rs. ${item.price}</p>
                        </div>
                    </div>
                    <button onclick="${onAddToCart}({name: '${item.name}', price: ${item.price}})" 
                            class="ripple-effect bg-orange-100 hover:bg-orange-200 text-[#6D4C41] p-2 rounded-lg transition-all active:scale-95 add-to-cart-btn">
                        +
                    </button>
                </div>
            `).join('');

            return `
                <div class="mb-10 category-section">
                    <h2 class="text-2xl font-bold text-[#6D4C41] mb-6 border-b-2 border-[#6D4C41] border-opacity-20 pb-2 inline-block">
                        ${title}
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        ${itemsHtml}
                    </div>
                </div>
            `;
        };

        const Menu = (menuData, onAddToCart) => {
            return `
                <section id="menu-section" class="py-12 bg-orange-50 smooth-scroll-target">
                    <div class="container mx-auto px-4">
                        <div class="text-center mb-12">
                            <h2 class="text-3xl md:text-4xl font-bold text-[#6D4C41] mb-3 font-script">Our Menu</h2>
                            <p class="text-gray-500">Handcrafted with love and tradition</p>
                        </div>
                        ${CategorySection("‚òï CHAAYE VARIANTS", menuData.chaaye, onAddToCart)}
                        ${CategorySection("‚òï COFFEE", menuData.coffee, onAddToCart)}
                        ${CategorySection("üçÆ DESSERTS & SNACKS", menuData.desserts, onAddToCart)}
                    </div>
                </section>
            `;
        };

        const TestimonialsSection = () => {
            const testimonialsHtml = testimonials.map((testimonial, index) => `
                <div class="testimonial-card p-6 rounded-xl stagger-item" style="animation-delay: ${index * 0.1}s">
                    <div class="flex items-center mb-3">
                        ${'‚òÖ'.repeat(testimonial.rating)}${'‚òÜ'.repeat(5 - testimonial.rating)}
                    </div>
                    <p class="text-gray-700 mb-4 italic">"${testimonial.comment}"</p>
                    <p class="font-semibold text-[#6D4C41]">- ${testimonial.name}</p>
                </div>
            `).join('');

            return `
                <section class="py-12 bg-white">
                    <div class="container mx-auto px-4">
                        <h2 class="text-3xl font-bold text-center text-[#6D4C41] mb-10">What Our Customers Say</h2>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            ${testimonialsHtml}
                        </div>
                    </div>
                </section>
            `;
        };

        const CartSheet = (isOpen, cart, onToggle, onUpdateQuantity, onOpenOrderModal, onDownloadPdf) => {
            if (!isOpen) return '';

            const cartItems = Object.keys(cart);
            const total = cartItems.reduce((sum, name) => sum + (cart[name].price * cart[name].qty), 0);

            const cartItemsHtml = cartItems.length === 0 ? `
                <div class="h-full flex flex-col items-center justify-center text-gray-400">
                    <span class="text-4xl mb-2 opacity-50">üõí</span>
                    <p>Your cart is empty</p>
                </div>
            ` : cartItems.map(name => `
                <div class="flex justify-between items-center bg-orange-50 p-3 rounded-lg border border-orange-100">
                    <div>
                        <h4 class="font-semibold text-gray-800">${name}</h4>
                        <p class="text-xs text-gray-500">Rs. ${cart[name].price} x ${cart[name].qty}</p>
                    </div>
                    <div class="flex items-center gap-3 bg-white rounded-lg p-1 shadow-sm">
                        <button onclick="${onUpdateQuantity}('${name}', ${cart[name].qty - 1})" 
                                class="p-1 hover:bg-gray-100 rounded text-red-500">
                            -
                        </button>
                        <span class="font-bold w-4 text-center text-sm">${cart[name].qty}</span>
                        <button onclick="${onUpdateQuantity}('${name}', ${cart[name].qty + 1})" 
                                class="p-1 hover:bg-gray-100 rounded text-green-500">
                            +
                        </button>
                    </div>
                </div>
            `).join('');

            return `
                <div class="fixed inset-0 z-50 flex justify-end">
                    <div class="absolute inset-0 bg-black/50 backdrop-blur-sm" onclick="${onToggle}"></div>
                    <div class="relative w-full max-w-md bg-white h-full shadow-2xl flex flex-col animate-slide-in-right">
                        <div class="p-4 bg-[#6D4C41] text-white flex justify-between items-center shadow-md">
                            <h2 class="text-lg font-bold flex items-center gap-2">
                                <span>üõí</span> Your Cart
                            </h2>
                            <button onclick="${onToggle}" class="hover:bg-white/20 p-1 rounded">‚úï</button>
                        </div>

                        <div class="flex-grow overflow-y-auto p-4">
                            ${cartItemsHtml}
                        </div>

                        <div class="p-4 border-t bg-gray-50">
                            <div class="flex justify-between items-center mb-4 text-lg font-bold text-[#6D4C41]">
                                <span>Total:</span>
                                <span>Rs. ${total}</span>
                            </div>
                            <div class="grid grid-cols-2 gap-3">
                                <button onclick="${onDownloadPdf}"
                                        ${cartItems.length === 0 ? 'disabled' : ''}
                                        class="flex items-center justify-center gap-2 bg-gray-600 text-white py-3 rounded-lg font-semibold hover:bg-gray-700 ${cartItems.length === 0 ? 'opacity-50 cursor-not-allowed' : ''}">
                                    üìÑ Invoice
                                </button>
                                <button onclick="${onOpenOrderModal}"
                                        ${cartItems.length === 0 ? 'disabled' : ''}
                                        class="flex items-center justify-center gap-2 bg-[#25D366] text-white py-3 rounded-lg font-semibold hover:bg-[#1fb859] ${cartItems.length === 0 ? 'opacity-50 cursor-not-allowed' : ''}">
                                    üí¨ WhatsApp
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        };

        const OrderModal = (isOpen, onClose, onConfirm) => {
            if (!isOpen) return '';

            return `
                <div class="fixed inset-0 z-50 flex items-center justify-center p-4">
                    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" onclick="${onClose}"></div>
                    <div class="bg-white w-full max-w-md rounded-2xl shadow-2xl z-10 overflow-hidden animate-scale-in">
                        <div class="bg-[#6D4C41] p-4 text-white flex justify-between items-center">
                            <h3 class="font-bold text-lg">Checkout Details</h3>
                            <button onclick="${onClose}">‚úï</button>
                        </div>
                        <form id="orderForm" class="p-6 space-y-4">
                            <div class="space-y-1 animate-form-field-appear" style="animation-delay: 0.1s">
                                <label class="text-xs font-bold text-gray-500 uppercase flex items-center gap-1">üë§ Name</label>
                                <input required type="text" id="customerName" 
                                       class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-[#6D4C41] outline-none bg-gray-50 form-field"
                                       placeholder="Enter your name">
                            </div>
                            <div class="space-y-1 animate-form-field-appear" style="animation-delay: 0.2s">
                                <label class="text-xs font-bold text-gray-500 uppercase flex items-center gap-1">üìû Phone</label>
                                <input required type="tel" id="customerPhone" 
                                       class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-[#6D4C41] outline-none bg-gray-50 form-field"
                                       placeholder="03XX-XXXXXXX">
                            </div>
                            <div class="space-y-1 animate-form-field-appear" style="animation-delay: 0.3s">
                                <label class="text-xs font-bold text-gray-500 uppercase flex items-center gap-1">üìç Address</label>
                                <textarea required rows="2" id="customerAddress"
                                          class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-[#6D4C41] outline-none bg-gray-50 form-field"
                                          placeholder="Delivery address"></textarea>
                            </div>
                            <div class="space-y-1 animate-form-field-appear" style="animation-delay: 0.4s">
                                <label class="text-xs font-bold text-gray-500 uppercase flex items-center gap-1">üìù Note (Optional)</label>
                                <input type="text" id="customerInstructions" 
                                       class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-[#6D4C41] outline-none bg-gray-50 form-field"
                                       placeholder="E.g., Less sugar">
                            </div>
                            <button type="submit" 
                                    class="w-full bg-[#6D4C41] text-white py-3 rounded-lg font-bold hover:bg-[#5D4037] transition-all mt-4 animate-form-field-appear" style="animation-delay: 0.5s">
                                Place Order
                            </button>
                        </form>
                    </div>
                </div>
            `;
        };

        const OrderConfirmation = () => {
            return `
                <div class="fixed inset-0 z-[60] flex items-center justify-center pointer-events-none">
                    <div class="bg-white px-8 py-6 rounded-2xl shadow-2xl flex flex-col items-center animate-scale-in border-2 border-green-500">
                        <span class="text-6xl text-green-500 mb-4 animate-bounce">‚úÖ</span>
                        <h2 class="text-2xl font-bold text-gray-800">Order Sent!</h2>
                        <p class="text-gray-500 text-center mt-2">Opening WhatsApp...</p>
                    </div>
                </div>
            `;
        };

        const MessageBox = (message, isError) => {
            if (!message) return '';
            return `
                <div class="fixed bottom-20 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-full shadow-lg z-50 text-white font-medium text-sm animate-fade-in-up ${isError ? 'bg-red-500' : 'bg-[#6D4C41]'}">
                    ${message}
                </div>
            `;
        };

        const Footer = () => {
            return `
                <footer class="bg-[#4E342E] text-[#D7CCC8] py-8 mt-auto">
                    <div class="container mx-auto px-4">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                            <div class="text-center md:text-left">
                                <span class="text-3xl mb-4 opacity-50">‚òï</span>
                                <h3 class="font-bold text-xl mb-2 font-script">Chaaye Junction</h3>
                                <p class="text-sm">Freshness in Every Sip</p>
                            </div>
                            <div class="text-center">
                                <h4 class="font-bold mb-3">Contact Info</h4>
                                <p class="text-sm mb-1">${restaurantPhone}</p>
                                <p class="text-xs opacity-50">Open Daily: 02:00 PM - 02:00 AM</p>
                            </div>
                            <div class="text-center md:text-right">
                                <h4 class="font-bold mb-3">Created By</h4>
                                <p class="text-sm mb-1">${creatorInfo.name}</p>
                                <p class="text-sm">${creatorInfo.contact}</p>
                            </div>
                        </div>
                        <div class="border-t border-[#5D4037] mt-6 pt-6 text-center">
                            <p class="text-xs opacity-50">
                                &copy; 2025 <strong>Chaaye Junction</strong>. All rights reserved.
                            </p>
                        </div>
                    </div>
                </footer>
            `;
        };

        // Main App
        class ChaayeJunctionApp {
            constructor() {
                this.state = {
                    isLoading: true,
                    cart: {},
                    isCartOpen: false,
                    isOrderModalOpen: false,
                    showOrderConfirmed: false,
                    message: null,
                    cartAnimation: false
                };

                this.prevCartCount = 0;
                this.init();
            }

            init() {
                // Load cart from localStorage
                try {
                    const savedCart = localStorage.getItem('chaayeJunctionCart');
                    if (savedCart) {
                        this.state.cart = JSON.parse(savedCart);
                        this.prevCartCount = this.getCartCount();
                    }
                } catch (error) {
                    console.error("Failed to load cart from localStorage", error);
                }

                // Hide splash screen after 2.5 seconds
                setTimeout(() => {
                    this.setState({ isLoading: false });
                }, 2500);

                this.render();
            }

            getCartCount() {
                return Object.keys(this.state.cart).reduce((sum, itemName) => sum + this.state.cart[itemName].qty, 0);
            }

            setState(newState) {
                const newCartCount = this.getCartCount();
                
                // Check if cart count increased
                if (newCartCount > this.prevCartCount) {
                    this.state.cartAnimation = true;
                    setTimeout(() => {
                        this.state.cartAnimation = false;
                        this.render();
                    }, 500);
                }
                
                this.prevCartCount = newCartCount;
                this.state = { ...this.state, ...newState };
                this.saveCartToStorage();
                this.render();
            }

            saveCartToStorage() {
                try {
                    localStorage.setItem('chaayeJunctionCart', JSON.stringify(this.state.cart));
                } catch (error) {
                    console.error("Failed to save cart to localStorage", error);
                }
            }

            showMessage(text, isError = false) {
                this.setState({ message: { text, isError } });
                setTimeout(() => {
                    this.setState({ message: null });
                }, 3000);
            }

            scrollToMenu() {
                const menuSection = document.getElementById('menu-section');
                if (menuSection) {
                    menuSection.scrollIntoView({ behavior: 'smooth' });
                }
            }

            handleAddToCart(item) {
                const newCart = { ...this.state.cart };
                if (newCart[item.name]) {
                    newCart[item.name].qty += 1;
                } else {
                    newCart[item.name] = { price: item.price, qty: 1 };
                }
                this.setState({ cart: newCart });
                this.showMessage(`Added ${item.name} to cart!`);
                
                // Trigger animation on the menu item card
                this.animateMenuItem(item.name);
            }

            animateMenuItem(itemName) {
                const itemId = `menu-item-${itemName.replace(/\s+/g, '-')}`;
                const itemElement = document.getElementById(itemId);
                
                if (itemElement) {
                    itemElement.classList.add('animate-item-added');
                    setTimeout(() => {
                        itemElement.classList.remove('animate-item-added');
                    }, 600);
                }
            }

            handleUpdateQuantity(name, newQty) {
                const newCart = { ...this.state.cart };
                if (newQty <= 0) {
                    delete newCart[name];
                } else {
                    newCart[name].qty = newQty;
                }
                this.setState({ cart: newCart });
            }

            handleConfirmOrder(details) {
                let total = 0;
                const itemsList = Object.keys(this.state.cart).map(itemName => {
                    const item = this.state.cart[itemName];
                    const itemTotal = item.price * item.qty;
                    total += itemTotal;
                    return `‚Ä¢ ${item.qty}x ${itemName}\n  (Rs. ${item.price} √ó ${item.qty} = *Rs. ${itemTotal}*)`;
                }).join('\n');
                
                const instructions = details.instructions || "None";
                const separator = '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ';

                let messageText = `‚òï *CHAAYE JUNCTION ORDER* ‚òï\n\n`;
                messageText += `*Order Details:*\n${separator}\n${itemsList}\n\n`;
                messageText += `${separator}\n*Grand Total: Rs. ${total}*\n\n`;
                messageText += `*Customer Information:*\nüßë Name: ${details.name}\nüìû Phone: ${details.phone}\nüè† Address: ${details.address}\nüìù Instructions: ${instructions}\n\n`;
                messageText += `Thank you! ‚ò∫\n${separator}\n_Digital Menu by ${creatorInfo.name} (${creatorInfo.contact})_`;

                const url = `https://wa.me/${phoneNumber}?text=${encodeURIComponent(messageText)}`;
                window.open(url, '_blank');

                this.setState({ 
                    showOrderConfirmed: true,
                    cart: {},
                    isOrderModalOpen: false,
                    isCartOpen: false
                });

                setTimeout(() => {
                    this.setState({ showOrderConfirmed: false });
                }, 3000);
            }

            handleDownloadPdf() {
                if (Object.keys(this.state.cart).length === 0) {
                    this.showMessage("Please add items to your cart first!", true);
                    return;
                }

                if (typeof jspdf === 'undefined') {
                    this.showMessage("PDF Generator is loading, please try again in 2 seconds...", true);
                    return;
                }

                try {
                    const { jsPDF } = jspdf;
                    const doc = new jsPDF();
                    
                    const customerName = "Guest User";
                    const orderId = `CJ-${Math.floor(100000 + Math.random() * 900000)}`;
                    const date = new Date().toLocaleString('en-US', {
                        year: 'numeric', month: '2-digit', day: '2-digit',
                        hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true
                    });
                    let total = 0;
                    let y = 75;

                    // Watermark
                    doc.saveGraphicsState();
                    doc.setFont('helvetica', 'bold');
                    doc.setFontSize(50);
                    doc.setTextColor(235, 235, 235);
                    doc.text("Chaaye Junction", 105, 180, { angle: -30, align: 'center' });
                    doc.restoreGraphicsState();
                    
                    // Header
                    const headerColor = '#6D4C41';
                    doc.setFillColor(headerColor);
                    doc.rect(0, 0, doc.internal.pageSize.width, 30, 'F');
                    
                    doc.setTextColor(255, 255, 255);
                    doc.setFont('helvetica', 'bold');
                    doc.setFontSize(18);
                    doc.text("CJ CHAAYE JUNCTION", 20, 18);
                    
                    doc.setFont('helvetica', 'normal');
                    doc.setFontSize(10);
                    doc.text("Freshness in Every Sip", 190, 15, { align: 'right' });
                    doc.text(restaurantPhone, 190, 21, { align: 'right' });

                    // Invoice Info
                    doc.setTextColor(0, 0, 0);
                    doc.setFont('helvetica', 'bold');
                    doc.setFontSize(16);
                    doc.text("INVOICE", 20, 50);

                    doc.setFont('helvetica', 'normal');
                    doc.setFontSize(10);
                    doc.text(`Order ID: ${orderId}`, 20, 58);
                    doc.text(`Bill To: ${customerName}`, 20, 63);
                    
                    doc.text(`Date: ${date}`, 190, 58, { align: 'right' });

                    // Table Header
                    doc.setFillColor('#F3F4F6');
                    doc.rect(20, y - 5, 170, 8, 'F');
                    
                    doc.setFont('helvetica', 'bold');
                    doc.text("Item", 25, y);
                    doc.text("Qty", 120, y, { align: 'right' });
                    doc.text("Price", 155, y, { align: 'right' });
                    doc.text("Total", 190, y, { align: 'right' });
                    y += 10;

                    // Table Items
                    doc.setFont('helvetica', 'normal');
                    for (const name of Object.keys(this.state.cart)) {
                        const item = this.state.cart[name];
                        const itemTotal = item.price * item.qty;
                        total += itemTotal;
                        
                        doc.text(name, 25, y);
                        doc.text(item.qty.toString(), 120, y, { align: 'right' });
                        doc.text(`Rs. ${item.price}`, 155, y, { align: 'right' });
                        doc.text(`Rs. ${itemTotal}`, 190, y, { align: 'right' });
                        y += 7;
                        
                        if (y > 250) {
                            doc.addPage();
                            y = 30;
                        }
                    }

                    // Total
                    y += 5;
                    doc.setDrawColor(0, 0, 0);
                    doc.line(125, y, 190, y);
                    y += 7;
                    
                    doc.setFont('helvetica', 'bold');
                    doc.setFontSize(12);
                    doc.text("GRAND TOTAL", 125, y);
                    doc.text(`Rs. ${total}`, 190, y, { align: 'right' });
                    
                    // Footer
                    const pageHeight = doc.internal.pageSize.height;
                    doc.setFont('helvetica', 'normal');
                    doc.setFontSize(8);
                    const footerY = pageHeight - 15;
                    doc.text("Thank you for your order! Payment is due upon delivery.", 105, footerY, { align: 'center' });
                    doc.text(`Created By: ${creatorInfo.name} | Contact: ${creatorInfo.contact}`, 105, footerY + 5, { align: 'center' });
                    doc.text("¬© 2025 Chaaye Junction. All rights reserved.", 105, footerY + 10, { align: 'center' });

                    doc.save(`ChaayeJunction_Invoice_${orderId}.pdf`);
                    this.showMessage("PDF Invoice download started.");

                } catch (e) {
                    this.showMessage("Failed to generate PDF.", true);
                    console.error("PDF Generation Error:", e);
                }
            }

            render() {
                const cartCount = this.getCartCount();

                if (this.state.isLoading) {
                    document.getElementById('root').innerHTML = SplashScreen();
                    return;
                }

                const mainContent = `
                    <div class="text-gray-800 flex flex-col min-h-screen">
                        ${Header(cartCount, 'app.toggleCart()', this.state.cartAnimation)}
                        
                        ${HeroSection()}
                        
                        ${FeaturesSection()}
                        
                        ${Menu(menuData, 'app.handleAddToCart')}
                        
                        ${TestimonialsSection()}

                        ${CartSheet(
                            this.state.isCartOpen,
                            this.state.cart,
                            'app.toggleCart()',
                            'app.handleUpdateQuantity',
                            'app.openOrderModal()',
                            'app.handleDownloadPdf()'
                        )}

                        ${OrderModal(
                            this.state.isOrderModalOpen,
                            'app.closeOrderModal()',
                            'app.submitOrder()'
                        )}

                        ${this.state.showOrderConfirmed ? OrderConfirmation() : ''}
                        
                        ${this.state.message ? MessageBox(this.state.message.text, this.state.message.isError) : ''}

                        ${Footer()}
                    </div>
                `;

                document.getElementById('root').innerHTML = mainContent;

                // Add event listeners
                this.setupEventListeners();
            }

            setupEventListeners() {
                // Add event listener for order form
                if (this.state.isOrderModalOpen) {
                    setTimeout(() => {
                        const form = document.getElementById('orderForm');
                        if (form) {
                            form.addEventListener('submit', (e) => {
                                e.preventDefault();
                                this.submitOrder();
                            });
                        }

                        // Add focus animations to form fields
                        const formFields = document.querySelectorAll('.form-field');
                        formFields.forEach(field => {
                            field.addEventListener('focus', () => {
                                field.classList.add('animate-field-focus');
                                setTimeout(() => {
                                    field.classList.remove('animate-field-focus');
                                }, 500);
                            });
                        });
                    }, 100);
                }
            }

            // Public methods for event handlers
            toggleCart() {
                this.setState({ isCartOpen: !this.state.isCartOpen });
            }

            openOrderModal() {
                if (Object.keys(this.state.cart).length === 0) {
                    this.showMessage("Please add items to your cart first!", true);
                    return;
                }
                this.setState({ 
                    isOrderModalOpen: true,
                    isCartOpen: false
                });
            }

            closeOrderModal() {
                this.setState({ isOrderModalOpen: false });
            }

            submitOrder() {
                const name = document.getElementById('customerName')?.value;
                const phone = document.getElementById('customerPhone')?.value;
                const address = document.getElementById('customerAddress')?.value;
                const instructions = document.getElementById('customerInstructions')?.value;

                if (!name || !phone || !address) {
                    this.showMessage("Please fill in all required fields!", true);
                    return;
                }

                this.handleConfirmOrder({
                    name,
                    phone,
                    address,
                    instructions
                });
            }
        }

        // Initialize the app
        const app = new ChaayeJunctionApp();

        // Make app globally available for event handlers
        window.app = app;
    </script>
</body>
</html>